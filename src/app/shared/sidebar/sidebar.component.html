<!-- Left Sidebar (Permanent, toggleable) -->
<div class="sidebar-container fixed top-0 left-0 h-full w-72 z-[60] flex flex-col transform transition-transform duration-300 ease-in-out"
    [class.translate-x-0]="sidebarService.isOpen()" [class.-translate-x-full]="!sidebarService.isOpen()">

    <!-- Scrollable Content Area -->
    <div class="flex-1 flex flex-col gap-4 p-4 overflow-y-auto pb-0">
        <!-- Header -->
        <div class="flex items-center justify-between pb-2 border-b border-dash-border">
            <h2 class="text-lg font-bold text-dash-text">Navigation</h2>
            <button (click)="toggleSidebar()" class="text-dash-text-dim hover:text-white transition-colors">
                <span class="material-symbols-sharp">chevron_left</span>
            </button>
        </div>

        <!-- Quick Actions: Export/Import (dezent) -->
        <div class="flex justify-center gap-3 text-dash-text-dim">
            <button (click)="exportAllData()"
                class="flex items-center gap-1.5 text-xs hover:text-dash-accent transition-colors"
                title="Alle Daten exportieren (Ctrl+E)">
                <span class="material-symbols-sharp text-sm">download</span>
                <span>Export</span>
                <span class="text-[10px] opacity-60">Ctrl+E</span>
            </button>
            <span class="text-dash-border">|</span>
            <button (click)="triggerImportAll()"
                class="flex items-center gap-1.5 text-xs hover:text-dash-accent transition-colors"
                title="Alle Daten importieren (Ctrl+I)">
                <span class="material-symbols-sharp text-sm">upload</span>
                <span>Import</span>
                <span class="text-[10px] opacity-60">Ctrl+I</span>
            </button>
        </div>

        <div class="border-t border-dash-border"></div>

        <!-- Projects Section -->
        <div>
            <h3 class="text-xs font-bold text-dash-text-dim uppercase tracking-wider mb-2 px-1">Projekte</h3>
            <div class="grid grid-cols-3 gap-2">
                <!-- Dashboard -->
                <a routerLink="/"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Dashboard (Alt+D)">
                    <span class="material-symbols-sharp text-2xl">dashboard</span>
                    <span class="text-[10px] font-medium">Dashboard</span>
                    <span class="text-[9px] opacity-60">Alt+D</span>
                </a>
                <!-- Journal App -->
                <a routerLink="/journal"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Journal (Alt+J)">
                    <span class="material-symbols-sharp text-2xl">book</span>
                    <span class="text-[10px] font-medium">Journal</span>
                    <span class="text-[9px] opacity-60">Alt+J</span>
                </a>
                <!-- My Budget -->
                <a routerLink="/budget"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Budget (Alt+B)">
                    <span class="material-symbols-sharp text-2xl">account_balance_wallet</span>
                    <span class="text-[10px] font-medium">Budget</span>
                    <span class="text-[9px] opacity-60">Alt+B</span>
                </a>
                <!-- Settings -->
                <button (click)="onSettingsClick()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-1 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Settings">
                    <span class="material-symbols-sharp text-2xl">settings</span>
                    <span class="text-[10px] font-medium">Settings</span>
                </button>
                <!-- Manga Builder Download -->
                <button (click)="downloadMangaBuilder()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-1 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Manga Builder (.exe)">
                    <span class="material-symbols-sharp text-2xl">book</span>
                    <span class="text-[10px] font-medium text-center leading-tight">Manga<br>Builder.exe</span>
                </button>
                <!-- AudioNotes Download -->
                <button (click)="downloadAudioNotes()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-1 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="AudioNotes (.apk)">
                    <span class="material-symbols-sharp text-2xl">mic</span>
                    <span class="text-[10px] font-medium text-center leading-tight">Audio<br>Notes.apk</span>
                </button>
                <!-- Install PWA -->
                <button *ngIf="pwa.canInstall()" (click)="installPwa()"
                    class="aspect-square bg-dash-bg/50 hover:bg-dash-accent rounded-sm flex flex-col items-center justify-center gap-1 cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Install App">
                    <span class="material-symbols-sharp text-2xl">download</span>
                    <span class="text-[10px] font-medium">Install</span>
                </button>
            </div>
        </div>

        <!-- Favorites Section -->
        <div *ngIf="bookmarkService.bookmarks().length > 0">
            <h3 class="text-xs font-bold text-dash-text-dim uppercase tracking-wider mb-2 px-1 flex items-center gap-2">
                Favoriten
                <span class="material-symbols-sharp text-[10px]">star</span>
            </h3>
            <div class="grid grid-cols-3 gap-2">
                <ng-container *ngFor="let bookmark of bookmarkService.bookmarks()">
                    <a *ngIf="bookmark.isFavorite" [href]="bookmark.url" target="_blank"
                        class="aspect-square gradient-card hover:border-dash-accent rounded-sm flex flex-col items-center justify-center gap-1 cursor-pointer text-dash-text hover:text-dash-accent transition-all group relative overflow-hidden hover:shadow-md"
                        [title]="bookmark.name">
                        <!-- Background hover effect -->
                        <div
                            class="absolute inset-0 bg-gradient-to-br from-dash-accent/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
                        </div>

                        <img [src]="bookmarkService.getFaviconUrl(bookmark.url)"
                            (error)="$event.target.style.display='none'" class="w-6 h-6 rounded-sm mb-1" alt="Icon">
                        <span class="text-[10px] font-medium truncate w-full text-center px-1">{{ bookmark.name
                            }}</span>
                    </a>
                </ng-container>
            </div>
        </div>
    </div>

    <!-- Music Player - Fixed at Bottom -->
    <div class="music-player-wrapper p-4 pt-2">
        <app-music-player></app-music-player>
    </div>

    <!-- Credits Footer -->
    <div
        class="credits-footer px-4 pb-3 pt-1 text-[9px] text-dash-text-dim/60 border-t border-dash-border/30 text-center">
        <span>Icons by <a href="https://www.flaticon.com" target="_blank" rel="noopener noreferrer"
                class="hover:text-dash-accent transition-colors underline">Flaticon</a> Â· Music by <a
                href="https://www.youtube.com/@LofiGirl" target="_blank" rel="noopener noreferrer"
                class="hover:text-dash-accent transition-colors underline">Lofi Girl</a></span>
    </div>
</div>