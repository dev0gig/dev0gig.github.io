<div class="min-h-screen text-dash-text p-4 md:p-8 font-sans selection:bg-dash-accent selection:text-white pb-16">
    <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-12 gap-4">

        <!-- Header -->
        <header
            class="md:col-span-12 flex items-center justify-between gradient-header p-3 md:p-4 rounded-sm sticky top-0 z-50 shadow-lg">
            <div class="flex items-center gap-2 md:gap-4">
                <button (click)="toggleSidebar()"
                    class="w-10 h-10 bg-dash-bg rounded-sm flex items-center justify-center hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all"
                    title="Menu">
                    <span class="material-symbols-sharp text-xl">menu</span>
                </button>
                <h1 class="text-xs md:text-sm font-bold tracking-widest text-dash-text-dim uppercase">MangaBuilder</h1>
            </div>
            <div class="flex gap-2 md:gap-4 text-xs font-mono text-dash-text-dim items-center">
                <div class="hidden sm:block">KAPITEL <span class="text-white">{{ chapters().length }}</span></div>
                <div class="hidden sm:block">BILDER <span class="text-white">{{ getTotalImageCount() }}</span></div>
                <button (click)="openReader()"
                    class="px-3 py-2 bg-dash-bg rounded-sm flex items-center gap-2 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all text-xs">
                    <span class="material-symbols-sharp text-sm">chrome_reader_mode</span>
                    <span class="hidden md:inline">Reader</span>
                </button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="md:col-span-8 lg:col-span-9 flex flex-col gap-4 order-2 md:order-1">
            <!-- Chapter Selection -->
            <div class="gradient-card p-4 rounded-sm">
                <h2 class="text-xs font-bold text-dash-text-dim uppercase mb-3 tracking-wider">Kapitel hinzufügen</h2>
                <app-chapter-selection [chapters]="chapters()" (chaptersChange)="onChaptersChange($event)"
                    (filesDropped)="onFilesDropped($event)">
                </app-chapter-selection>
            </div>
        </main>

        <!-- Sidebar / Right Column -->
        <aside class="md:col-span-4 lg:col-span-3 flex flex-col gap-4 order-1 md:order-2">
            <!-- Cover -->
            <div class="gradient-card p-4 rounded-sm">
                <app-cover-management [cover]="cover()" (coverChange)="onCoverChange($event)">
                </app-cover-management>
            </div>

            <!-- Output Settings -->
            <div class="gradient-card p-4 rounded-sm">
                <h2 class="text-xs font-bold text-dash-text-dim uppercase mb-3 tracking-wider">Ausgabe</h2>
                <div class="flex flex-col gap-3">
                    <div class="flex flex-col gap-1">
                        <label for="filename" class="text-xs text-dash-text-dim">Dateiname</label>
                        <input type="text" id="filename" [(ngModel)]="outputFilename" placeholder="manga_merged.cbz"
                            class="w-full bg-dash-bg border border-dash-border text-dash-text px-3 py-2 rounded-sm focus:outline-none focus:border-dash-accent text-sm">
                    </div>
                    <div class="flex gap-2">
                        <button (click)="clearAll()" [disabled]="chapters().length === 0"
                            class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-dash-bg border border-dash-border hover:border-red-500 text-dash-text-dim hover:text-red-500 rounded-sm transition-colors text-xs disabled:opacity-50 disabled:cursor-not-allowed">
                            <span class="material-symbols-sharp text-sm">delete</span>
                            Löschen
                        </button>
                        <button (click)="mergeCBZ()" [disabled]="!canMerge()"
                            class="flex-1 gradient-btn text-white px-3 py-2 rounded-sm text-xs font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                            <span class="material-symbols-sharp text-sm">merge</span>
                            CBZ erstellen
                        </button>
                    </div>
                </div>
            </div>
        </aside>

    </div>

    <!-- Progress Overlay -->
    <app-progress-feedback [progress]="progress()"></app-progress-feedback>
</div>