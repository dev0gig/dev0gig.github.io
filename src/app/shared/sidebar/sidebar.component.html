<!-- Left Sidebar (Permanent, toggleable) -->
<div class="sidebar-container fixed top-0 left-0 h-full w-72 z-[60] flex flex-col transform transition-transform duration-300 ease-in-out"
    [class.translate-x-0]="sidebarService.isOpen()" [class.-translate-x-full]="!sidebarService.isOpen()">

    <!-- Scrollable Content Area -->
    <div class="flex-1 flex flex-col gap-4 p-4 overflow-y-auto pb-0">
        <!-- Header -->
        <div class="flex items-center justify-between pb-2 border-b border-dash-border">
            <h2 class="text-lg font-bold text-dash-text">Navigation</h2>
            <button (click)="toggleSidebar()" class="text-dash-text-dim hover:text-white transition-colors">
                <span class="material-symbols-sharp">chevron_left</span>
            </button>
        </div>

        <!-- Quick Actions -->
        <div class="flex flex-col gap-2">
            <!-- Row 1: Export/Import -->
            <div class="flex justify-center gap-3 text-dash-text-dim">
                <button (click)="exportAllData()"
                    class="flex items-center gap-1.5 text-xs hover:text-dash-accent transition-colors"
                    title="Alle Daten exportieren (Ctrl+E)">
                    <span class="material-symbols-sharp text-sm">download</span>
                    <span>Export</span>
                    <span class="text-[10px] opacity-60">Ctrl+E</span>
                </button>
                <span class="text-dash-border">|</span>
                <button (click)="triggerImportAll()"
                    class="flex items-center gap-1.5 text-xs hover:text-dash-accent transition-colors"
                    title="Alle Daten importieren (Ctrl+I)">
                    <span class="material-symbols-sharp text-sm">upload</span>
                    <span>Import</span>
                    <span class="text-[10px] opacity-60">Ctrl+I</span>
                </button>
            </div>
            <!-- Row 2: Quick Note & Quick Calc -->
            <div class="flex justify-center gap-3 text-dash-text-dim">
                <button (click)="openQuickNote()"
                    class="flex items-center gap-1.5 text-xs hover:text-amber-400 transition-colors"
                    title="Schnellnotiz (Alt+N)">
                    <span class="material-symbols-sharp text-sm">edit_note</span>
                    <span>Notiz</span>
                    <span class="text-[10px] opacity-60">Alt+N</span>
                </button>
                <span class="text-dash-border">|</span>
                <button (click)="openQuickCalc()"
                    class="flex items-center gap-1.5 text-xs hover:text-emerald-400 transition-colors"
                    title="Schnellrechner (Alt+R)">
                    <span class="material-symbols-sharp text-sm">calculate</span>
                    <span>Rechner</span>
                    <span class="text-[10px] opacity-60">Alt+R</span>
                </button>
            </div>
        </div>

        <div class="border-t border-dash-border"></div>

        <!-- Settings Button - Full Width -->
        <button (click)="onSettingsClick()"
            class="w-full bg-dash-bg rounded-md flex items-center gap-3 px-3 py-2.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
            title="Settings">
            <span class="material-symbols-sharp text-xl">settings</span>
            <span class="text-sm font-medium">Settings</span>
        </button>

        <!-- Projects Section -->
        <div>
            <h3 class="text-xs font-bold text-dash-text-dim uppercase tracking-wider mb-2 px-1">Projekte</h3>
            <div class="grid grid-cols-3 gap-2">
                <!-- Dashboard -->
                <a routerLink="/" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Dashboard">
                    <span class="material-symbols-sharp text-2xl">dashboard</span>
                    <span class="text-[10px] font-medium">Dashboard</span>
                </a>
                <!-- Journal App -->
                <a routerLink="/journal" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Journal">
                    <span class="material-symbols-sharp text-2xl">book</span>
                    <span class="text-[10px] font-medium">Journal</span>
                </a>
                <!-- My Budget -->
                <a routerLink="/budget" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Budget">
                    <span class="material-symbols-sharp text-2xl">account_balance_wallet</span>
                    <span class="text-[10px] font-medium">Budget</span>
                </a>
                <!-- Manga Builder -->
                <a routerLink="/manga-builder" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Manga Builder">
                    <span class="material-symbols-sharp text-2xl">auto_stories</span>
                    <span class="text-[10px] font-medium text-center leading-tight">Manga<br>Builder</span>
                </a>
                <!-- Savings Simulator -->
                <a routerLink="/savings-simulator" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Savings Sim">
                    <span class="material-symbols-sharp text-2xl">savings</span>
                    <span class="text-[10px] font-medium text-center leading-tight">Savings<br>Sim</span>
                </a>
                <!-- AudioNotes -->
                <a routerLink="/audio-notes" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="AudioNotes">
                    <span class="material-symbols-sharp text-2xl">mic</span>
                    <span class="text-[10px] font-medium text-center leading-tight">Audio<br>Notes</span>
                </a>
                <!-- MTG Inventory -->
                <a routerLink="/mtg-inventory" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="MTG Inventory">
                    <span class="material-symbols-sharp text-2xl">playing_cards</span>
                    <span class="text-[10px] font-medium text-center leading-tight">MTG<br>Inventory</span>
                </a>
                <!-- Flashcards -->
                <a routerLink="/flashcards" (click)="closeSidebarOnMobile()"
                    class="aspect-square bg-dash-bg rounded-sm flex flex-col items-center justify-center gap-0.5 hover:bg-dash-accent cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Flashcards">
                    <span class="material-symbols-sharp text-2xl">style</span>
                    <span class="text-[10px] font-medium">Flashcards</span>
                </a>
                <!-- Install PWA -->
                <button *ngIf="pwa.canInstall()" (click)="installPwa()"
                    class="aspect-square bg-dash-bg/50 hover:bg-dash-accent rounded-sm flex flex-col items-center justify-center gap-1 cursor-pointer text-dash-text-dim hover:text-white transition-all hover:shadow-md"
                    title="Install App">
                    <span class="material-symbols-sharp text-2xl">download</span>
                    <span class="text-[10px] font-medium">Install</span>
                </button>
            </div>
        </div>

        <!-- Favorites Section -->
        <div *ngIf="bookmarkService.bookmarks().length > 0">
            <h3 class="text-xs font-bold text-dash-text-dim uppercase tracking-wider mb-2 px-1 flex items-center gap-2">
                Favoriten
                <span class="material-symbols-sharp text-[10px]">star</span>
            </h3>
            <div class="grid grid-cols-3 gap-2">
                <ng-container *ngFor="let bookmark of bookmarkService.bookmarks()">
                    <a *ngIf="bookmark.isFavorite" [href]="bookmark.url" target="_blank"
                        (click)="closeSidebarOnMobile()"
                        class="aspect-square gradient-card hover:border-dash-accent rounded-sm flex flex-col items-center justify-center gap-1 cursor-pointer text-dash-text hover:text-dash-accent transition-all group relative overflow-hidden hover:shadow-md"
                        [title]="bookmark.name">
                        <!-- Background hover effect -->
                        <div
                            class="absolute inset-0 bg-gradient-to-br from-dash-accent/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
                        </div>

                        <img [src]="bookmarkService.getFaviconUrl(bookmark.url)"
                            (error)="$event.target.style.display='none'" class="w-6 h-6 rounded-sm mb-1" alt="Icon">
                        <span class="text-[10px] font-medium truncate w-full text-center px-1">{{ bookmark.name
                            }}</span>
                    </a>
                </ng-container>
            </div>
        </div>
    </div>
</div>