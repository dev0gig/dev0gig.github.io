<div class="flex flex-col gap-4">
    <!-- Drop Zone -->
    <div class="border-2 border-dashed border-dash-border rounded-sm p-6 text-center cursor-pointer transition-all duration-200 hover:border-dash-accent hover:bg-dash-bg/50"
        [class.border-dash-accent]="isDragging" [class.bg-dash-accent/10]="isDragging" (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)" (drop)="onDrop($event)" (click)="fileInput.click()">
        <span class="material-symbols-sharp text-3xl text-dash-text-dim mb-2 block">upload_file</span>
        <p class="text-sm text-dash-text-dim">CBZ, ZIP oder Bilder hierher ziehen</p>
        <p class="text-xs text-dash-text-dim/50 mt-1">oder klicken zum Auswählen</p>
        <input #fileInput type="file" accept=".cbz,.zip,.jpg,.jpeg,.png,.webp" multiple (change)="onFileSelect($event)"
            class="hidden">
    </div>

    <!-- Chapter List -->
    <div *ngIf="chapters.length > 0" class="flex flex-col">
        <div class="flex justify-between items-center p-3 bg-dash-bg rounded-t-sm border-b border-dash-border">
            <span class="text-sm font-medium text-dash-text">{{ chapters.length }} Kapitel ({{ getTotalImages() }}
                Bilder)</span>
            <div class="flex gap-2">
                <button (click)="sortChapters()"
                    class="p-1.5 rounded-sm hover:bg-dash-border text-dash-text-dim hover:text-white transition-colors"
                    title="Auto-Sortieren">
                    <span class="material-symbols-sharp text-lg">sort</span>
                </button>
                <button (click)="clearAll()"
                    class="p-1.5 rounded-sm hover:bg-red-500/20 text-dash-text-dim hover:text-red-500 transition-colors"
                    title="Alle löschen">
                    <span class="material-symbols-sharp text-lg">delete</span>
                </button>
            </div>
        </div>

        <div class="max-h-[300px] overflow-y-auto bg-dash-bg/50 rounded-b-sm">
            <div *ngFor="let chapter of chapters; let i = index"
                class="flex items-center gap-3 p-3 border-b border-dash-border last:border-0 hover:bg-dash-card-hover transition-colors"
                [class.bg-red-500/10]="chapter.isDuplicate">
                <span class="text-xs text-dash-text-dim w-6 text-center font-mono">{{ i + 1 }}</span>
                <span class="flex-1 text-sm text-dash-text truncate" [title]="chapter.name">
                    {{ chapter.name }}
                    <span *ngIf="chapter.isDuplicate"
                        class="ml-2 px-1.5 py-0.5 text-[10px] bg-red-500/20 text-red-400 rounded">Duplikat?</span>
                </span>
                <span class="text-xs text-dash-text-dim font-mono">{{ chapter.files.length }}</span>
                <div class="flex gap-1">
                    <button (click)="moveUp(i)" [disabled]="i === 0"
                        class="p-1 rounded hover:bg-dash-border text-dash-text-dim hover:text-white transition-colors disabled:opacity-30 disabled:cursor-not-allowed">
                        <span class="material-symbols-sharp text-sm">arrow_upward</span>
                    </button>
                    <button (click)="moveDown(i)" [disabled]="i === chapters.length - 1"
                        class="p-1 rounded hover:bg-dash-border text-dash-text-dim hover:text-white transition-colors disabled:opacity-30 disabled:cursor-not-allowed">
                        <span class="material-symbols-sharp text-sm">arrow_downward</span>
                    </button>
                    <button (click)="removeChapter(i)"
                        class="p-1 rounded hover:bg-red-500/20 text-dash-text-dim hover:text-red-500 transition-colors">
                        <span class="material-symbols-sharp text-sm">close</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>